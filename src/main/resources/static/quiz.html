<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <title>Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; }
    .quiz-container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .question { margin-bottom: 25px; }
    .question h3 { margin-bottom: 10px; }
    .options label {
      display: block;
      margin-bottom: 8px;
      cursor: pointer;
    }
    button {
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    .result { margin-top: 20px; font-weight: bold; }
    .warning {
      color: red;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="quiz-container">
  <h1>Quiz Səhifəsi</h1>
  <div id="quiz"></div>
  <button onclick="submitQuiz()">Cavabları Yoxla</button>
  <div id="result" class="result"></div>
</div>

<script>
  const quizData = JSON.parse(localStorage.getItem("quizQuestions") || "[]");
  const userAnswers = new Map();

  function renderQuiz() {
    const quizDiv = document.getElementById("quiz");
    quizDiv.innerHTML = '';

    if (!quizData || quizData.length === 0) {
      quizDiv.innerHTML = '<p class="warning">Sual tapılmadı. Zəhmət olmasa PDF-i düzgün yüklədiyinizdən əmin olun.</p>';
      return;
    }

    quizData.forEach((q, idx) => {
      const qDiv = document.createElement("div");
      qDiv.classList.add("question");
      qDiv.innerHTML = `<h3>${idx + 1}. ${q.questionText}</h3>`;

      if (!q.options || q.options.length === 0) {
        const warning = document.createElement("p");
        warning.className = "warning";
        warning.textContent = "Cavab variantları mövcud deyil.";
        qDiv.appendChild(warning);
      } else {
        const optionsDiv = document.createElement("div");
        optionsDiv.classList.add("options");

        q.options.forEach(opt => {
          const option = document.createElement("label");
          option.innerHTML = `
            <input type="radio" name="q${q.id}" value="${opt.id}" onchange="userAnswers.set(${q.id}, ${opt.id})">
            ${opt.optionText}
          `;
          optionsDiv.appendChild(option);
        });

        qDiv.appendChild(optionsDiv);
      }

      quizDiv.appendChild(qDiv);
    });
  }

  function submitQuiz() {
    let correct = 0;
    quizData.forEach(q => {
      const selectedId = userAnswers.get(q.id);
      const correctOption = q.options?.find(o => o.isCorrect);
      if (selectedId && correctOption && selectedId === correctOption.id) {
        correct++;
      }
    });

    const resultDiv = document.getElementById("result");
    resultDiv.textContent = `Sizin nəticəniz: ${correct} / ${quizData.length}`;
  }

  document.addEventListener("DOMContentLoaded", renderQuiz);
</script>

</body>
</html>
